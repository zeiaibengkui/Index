var listEl=document.getElementById("list");function getElementIndex(e){var t;return Array.prototype.indexOf.call(null===(t=e.parentNode)||void 0===t?void 0:t.children,e)}function edit(e){e.getAttribute("contenteditable")||(e.innerHTML=JSON.stringify({href:e.getAttribute("href"),name:e.textContent}),e.setAttribute("contenteditable",""),e.parentNode.setAttribute("draggable","false"),e.focus(),processEdit(e))}function processEdit(n){n.addEventListener("blur",function(){var e;n.textContent||null!==(e=n.parentElement)&&void 0!==e&&e.remove();try{if(!n)return;var t=JSON.parse(n.textContent||"null");document.querySelectorAll("#list a").forEach(function(e){if(e.textContent==t.name)throw new Error("There's already a same-named link! Please try a new name.")}),n.innerHTML=t.name,n.setAttribute("href",t.href),n.removeAttribute("contenteditable"),n.parentNode.setAttribute("draggable","true"),save()}catch(e){throw processEdit(n),e}},{once:!0})}function add(){var e=document.createElement("a"),t=document.createElement("li");e.setAttribute("href","https://");var n=document.createTextNode("Title");e.appendChild(n),t.appendChild(e),dragganle(t),listEl.appendChild(t),edit(e)}window.getElementIndex=getElementIndex,window.edit=edit,document.addEventListener("contextmenu",function(e){var t=e.target;1<t.childNodes.length||"A"!==t.tagName||(e.preventDefault(),edit(t))}),window.add=add,window.addEventListener("keyup",function(e){"KeyA"==e.code&&e.altKey&&add()});var addEl=document.getElementById("add");null!=addEl&&addEl.addEventListener("click",add);var removeEl=document.getElementById("remove");function remove(e){var t,n=null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("Index"),r=document.querySelectorAll("#list li")[n];console.log(n,listEl.children,r),r.remove()}function save(){var t={};document.querySelectorAll("#list a").forEach(function(e){t[e.textContent||"nothing"]=e.getAttribute("href")}),console.log(t),localStorage.setItem("list",JSON.stringify(t)),message.add("Saved!","success")}function dragganle(e){e.children[0].setAttribute("draggable","false"),e.setAttribute("draggable","true"),e.addEventListener("dragstart",function(e){var t;null!==(t=e.dataTransfer)&&void 0!==t&&t.setData("Index",getElementIndex(e.target).toString()),e.dataTransfer.dropEffect="move"})}window.remove=remove,removeEl.addEventListener("drop",remove),removeEl.addEventListener("dragover",function(e){return e.preventDefault()}),window.addEventListener("beforeunload",function(e){document.querySelector("a[contenteditable]")&&e.preventDefault(),save()}),window.addEventListener("DOMContentLoaded",function(){var e=JSON.parse(localStorage.getItem("list")||"{}");for(var t in e){var n=document.createElement("a"),r=document.createElement("li");n.setAttribute("href",e[t]);var d=document.createTextNode(t);n.appendChild(d),r.appendChild(n),dragganle(r),listEl.appendChild(r)}});